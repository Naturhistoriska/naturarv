<html xmlns="http://www.w3.org/1999/xhtml"   
      xmlns:ui="http://java.sun.com/jsf/facelets" 
      xmlns:p="http://primefaces.org/ui"  
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"    >

  <body>
    <ui:composition>       
     
      <h:panelGrid id="imagePanel" styleClass="imagePanel" columns="2" >   
        <h:panelGrid width="200">  
          <h:outputText value="#{msg.imagefilter}"  styleClass="imageViewPanel" /> 
          <p:panel header="#{msg.selectview}" id="selectViewPanel" >   
            <h:selectManyCheckbox value="#{galleria.viewList}" layout="pageDirection" >
              <f:selectItem itemValue="all" itemLabel="#{msg.all}" />
              <f:selectItem itemValue="label" itemLabel="#{msg.label}" />
              <f:selectItem itemValue="dorsal" itemLabel="#{msg.dorsal}" />
              <f:selectItem itemValue="ventral" itemLabel="#{msg.ventral}" />
              <f:selectItem itemValue="lateral" itemLabel="#{msg.lateral}" />
              <f:selectItem itemValue="frontal" itemLabel="#{msg.frontal}" />
              <f:selectItem itemValue="caudal" itemLabel="#{msg.caudal}" />

              <f:ajax render="imagePanel" listener="#{galleria.selectViews}" event="change" execute="@this" /> 
            </h:selectManyCheckbox> 
          </p:panel>  

          <p:panel header="#{msg.selectpart}" id="selectPartPanel" >  
            <h:selectManyCheckbox value="#{galleria.partsList}" layout="pageDirection" >
              <f:selectItem itemValue="all" itemLabel="#{msg.all}"  />  
              <f:selectItem itemValue="abdomen" itemLabel="#{msg.abdomen}" />  
              <f:selectItem itemValue="face"  itemLabel="#{msg.face}"/>   
              <f:selectItem itemValue="genitalia" itemLabel="#{msg.genitalia}" />  
              <f:selectItem itemValue="wings"  itemLabel="#{msg.wings}"/>  
              <f:selectItem itemValue="head" itemLabel="#{msg.head}" />  
              <f:selectItem itemValue="legs"  itemLabel="#{msg.legs}"/>  
              <f:selectItem itemValue="lobe" itemLabel="#{msg.lobe}" />  
              <f:selectItem itemValue="pronotum"  itemLabel="#{msg.pronotum}"/>  
              <f:selectItem itemValue="vari" itemLabel="#{msg.vari}" />  
              <f:selectItem itemValue="mesonotum"  itemLabel="#{msg.mesonotum}"/>  
              <f:selectItem itemValue="posterior" itemLabel="#{msg.posterior}" />  
              <f:selectItem itemValue="palps"  itemLabel="#{msg.palps}"/>  
              <f:selectItem itemValue="tarsi" itemLabel="#{msg.tarsi}" />  
              <f:selectItem itemValue="labrum"  itemLabel="#{msg.labrum}"/>  
              <f:selectItem itemValue="/notum/" itemLabel="#{msg.notum}" />  
              <f:selectItem itemValue="mouth"  itemLabel="#{msg.mouth}"/>  
              <f:selectItem itemValue="chelicerae" itemLabel="#{msg.chelicerae}" />   

              <p:ajax event="change" listener="#{galleria.selectParts}" global="false"  update="imagePanel" />   
            </h:selectManyCheckbox> 
          </p:panel> 

          <p:panel header="#{msg.selectsex}" id="selectSexPanel" >  
            <h:selectManyCheckbox value="#{galleria.sexList}" layout="pageDirection" >
              <f:selectItem itemValue="all" itemLabel="#{msg.all}" />  
              <f:selectItem itemValue="/male/" itemLabel="#{msg.male}" />  
              <f:selectItem itemValue="female"  itemLabel="#{msg.female}"/>   
              <f:ajax render="imagePanel" listener="#{galleria.selectSexes}" event="change" execute="@this" />  
            </h:selectManyCheckbox>  
          </p:panel> 

          <p:panel header="#{msg.selectstage}" id="selectStagePanel" >  
            <h:selectManyCheckbox value="#{galleria.stageList}" layout="pageDirection" >
              <f:selectItem itemValue="all" itemLabel="#{msg.all}" />  
              <f:selectItem itemValue="larva" itemLabel="#{msg.larva}" />  
              <f:selectItem itemValue="adult"  itemLabel="#{msg.adult}"/>   
              <f:ajax render="imagePanel" listener="#{galleria.selectStages}" event="change" execute="@this" />  
            </h:selectManyCheckbox>   
          </p:panel>   
        </h:panelGrid >

        <h:panelGrid width="500" > 
          <p:dataScroller var="image" value="#{galleria.model}" lazy="true" 
                          scrollHeight="800" rows="50" chunkSize="100"  
                          mode="inline"> 

            <p:panel header="#{image.catalogNumber}" style="text-align:center">
              <h:panelGrid columns="1" style="width:100%">
                <p:graphicImage value="#{galleria.getThumbPath(image.imageId)}"  
                                alt="#{image.catalogNumber}" 
                                title="#{image.txFullName}"  styleClass="imageswithpedding" />  

                <h:outputText value="#{image.txFullName}" />
                <ui:remove>
                  <p:commandLink update=":form:carDetail" oncomplete="PF('carDialog').show()" title="View Detail">
                  <h:outputText styleClass="pi pi-search" style="margin:0 auto;"/>
                  <f:setPropertyActionListener value="#{car}" target="#{dataGridView.selectedCar}" />
                </p:commandLink> 
                </ui:remove>
                  
                
              </h:panelGrid>
            </p:panel>


              
                 
              
            </p:dataScroller>  
        </h:panelGrid>
        
        <ui:remove> 
          <h:panelGrid width="500" style="vertical-align: top;"> 
          <p:growl id="msgs" showDetail="true" />
          <p:dataTable id="imageTable" var="image" value="#{galleria.model}" 
                       lazy="true" liveScroll="true" liveScrollBuffer="200"
                       scrollRows="100" virtualScroll="true"  
                       rows="40" styleClass="imageResultTable"
                       scrollable="true" scrollHeight="1100">
             
            <p:column>  
              <p:graphicImage value="#{galleria.getThumbPath(image)}" alt="#{image.catalogNumber}" 
                              title="#{image.txFullName}"  styleClass="imageswithpedding" />  
      
            </p:column>
           
          </p:dataTable>

          <p:blockUI block="imageTable" trigger="imageTable">
            LOADING<br />
            <p:graphicImage name="demo/images/ajaxloadingbar.gif"/>
          </p:blockUI>
        </h:panelGrid> 
        </ui:remove>
        
      </h:panelGrid>   

        
           <ui:remove>
             
             
             <h:panelGrid width="500">   
          <ui:repeat value="#{galleria.images}" var="subImages" > 
            <p:outputPanel deferred="true" deferredMode="visible" 
                           layout="block" style="width: 500px; float:right;"  >  
              <ui:repeat value="#{subImages}" var="image" >  
                <p:commandLink  action="#{switch.imageSwitch(image)}" 
                                oncomplete="PF('imgswitchdlg').show();" update="@this">
                  <p:graphicImage value="#{switch.thumbPath}" title="#{image.txFullName}/#{image.catalogNumber}" 
                                  alt="#{thumb.catalogNumber}" style="padding: 5px; border: none;"  /> 

                </p:commandLink>   
              </ui:repeat> 
            </p:outputPanel>  
          </ui:repeat> 
        </h:panelGrid >
      
                  <p:dialog id="imgswitchdialog" closable="true"  widgetVar="imgswitchdlg"   
                      draggable="false" header="#{msg.imageswitcher} (#{msg.imgmouseover})" > 
              <p:panel id="imageswitchpanel">
                <p:galleria id="images" widgetVar="gallery" value="#{imageSwitcher.thumbs}" 
                            panelWidth="420" panelHeight="500"   autoPlay="false"
                            var="thumb"  showCaption="true" >    
                  <p:graphicImage value="#{thumb}" alt="#{imageSwitcher.catalogNumber}" 
                                  title="#{imageSwitcher.txFullName}"  styleClass="imageswithpedding" />     

                </p:galleria>     
                <p:contextMenu for="images" style="z-index:50; font-size: 10px;">  
                  <p:menuitem value="Morphbank" url="http://morphbank.nrm.se/Browse/ByImage/?specimenId=#{imageSwitcher.mbid}"   
                              target="_blank"   icon="ui-icon-extlink"/>    
                  <p:menuitem value="Naturforskaren" url="http://naturforskaren.se/search/#{imageSwitcher.txFullName}"    
                              target="_blank"   icon="ui-icon-extlink"/>   
                  <p:menuitem value="GIBF.se" url="http://old.gbif.se/search/#{imageSwitcher.txFullName}"    
                              target="_blank"   icon="ui-icon-extlink"/>  
                  <p:menuitem value="GIBF" url="http://data.gbif.org/search/#{imageSwitcher.txFullName}"    
                              target="_blank"   icon="ui-icon-extlink"/>  
                  <p:menuitem value="#{msg.btnclose}" url="javascript:void(0)" onclick="PF('imgswitchdlg').hide();" icon="ui-icon-close"/>    
                </p:contextMenu> 
              </p:panel>

            </p:dialog>
        </ui:remove>
    </ui:composition>
  </body>
</html>

